openapi: 3.0.3
info:
  title: "Auth Module API Specification"
  version: 1.0.0
  description: "ì¸ì¦ ëª¨ë“ˆì˜ pathsì™€ components ëª…ì„¸ (RegisterRequest í•„ë“œ í™•ì¥ ë°˜ì˜)"
paths:
  /auth/register:
    post:
      tags:
        - Auth
      summary: ì‚¬ìš©ì íšŒì›ê°€ì…
      operationId: registerUser
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RegisterRequest'
      responses:
        '201':
          description: íšŒì›ê°€ì… ì„±ê³µ
          content:
            application/json:
              schema:
                type: object
                properties:
                  userId:
                    type: string
                    format: uuid
                    description: ë“±ë¡ëœ ì‚¬ìš©ì ID (UUID í˜•ì‹)
        '400':
          $ref: '#/components/responses/RegisterBadRequestError' # êµ¬ì²´ì ì¸ 400 ì—ëŸ¬ë¥¼ ì°¸ì¡°
        '409':
          description: ë°ì´í„° ì¶©ëŒ (ì´ë©”ì¼/ID ì¤‘ë³µ)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                code: "AUTH_004"
                message: "ì´ë¯¸ ì‚¬ìš© ì¤‘ì¸ ì‚¬ìš©ì IDì…ë‹ˆë‹¤."

  /auth/login:
    post:
      tags:
        - Auth
      summary: ì‚¬ìš©ì ë¡œê·¸ì¸ ë° í† í° ë°œê¸‰
      operationId: loginUser
      requestBody:
        required: true
        description: ë¡œê·¸ì¸ ìš”ì²­ ë°ì´í„°
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LoginRequest'
      responses:
        '200':
          description: ë¡œê·¸ì¸ ì„±ê³µ ë° í† í° ë°œê¸‰
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LoginResponse'
        '401':
          $ref: '#/components/responses/LoginUnauthorizedError' # êµ¬ì²´ì ì¸ 401 ì—ëŸ¬ë¥¼ ì°¸ì¡°
        '400':
          $ref: '#/components/responses/BadRequestError' # ì¼ë°˜ì ì¸ 400 ì—ëŸ¬ ì°¸ì¡°
  /auth/logout: # ğŸ’¡ [ìˆ˜ì •] /auth/loginê³¼ ë™ì¼ ë ˆë²¨ë¡œ ê²½ë¡œ ìˆ˜ì •
    post:
      tags:
        - Auth
      summary: ì‚¬ìš©ì ë¡œê·¸ì•„ì›ƒ ë° Access Token ë¬´íš¨í™”
      operationId: logoutUser
      description: í˜„ì¬ ì‚¬ìš© ì¤‘ì¸ Access Tokenì„ ë¸”ë™ë¦¬ìŠ¤íŠ¸ì— ë“±ë¡í•˜ì—¬ ì¦‰ì‹œ ë¬´íš¨í™”í•©ë‹ˆë‹¤.
      security:
        - cookieAuth: [ ]
      responses:
        '204':
          description: ë¡œê·¸ì•„ì›ƒ ì„±ê³µ (Content-Typeì´ ì—†ëŠ” ì‘ë‹µ)
        '401':
          $ref: '#/components/responses/UnauthorizedError' # í† í°ì´ ì—†ê±°ë‚˜ ìœ íš¨í•˜ì§€ ì•ŠìŒ (AUTH_002)
components:
  # --- Schemas (ë°ì´í„° ëª¨ë¸) ---
  schemas:
    RegisterRequest:
      type: object
      required:
        - email
        - password
        - name
        - role
        - tags
        - learnerLevel
      properties:
        email:
          type: string
          format: email
          description: ì‚¬ìš©ì ì´ë©”ì¼ (ë¡œê·¸ì¸ ID)
          example: "user@example.com"
        password:
          type: string
          format: password
          description: ì‚¬ìš©ì ë¹„ë°€ë²ˆí˜¸
          example: "StrongP@ss123"
        name:
          type: string
          description: ì‚¬ìš©ì ì´ë¦„
          example: "í™ê¸¸ë™"
        role:
          type: string
          description: ì‚¬ìš©ì ì—­í•  (LEARNER, INSTRUCTOR)
          example: "LEARNER"
          enum: [ "LEARNER", "INSTRUCTOR", "ADMIN" ]
        tags:
          type: array
          items:
            type: integer
            format: int64
          description: ê´€ì‹¬ì‚¬ íƒœê·¸ ID ëª©ë¡ (ìµœì†Œ 3ê°œ, ìµœëŒ€ 5ê°œ)
          minItems: 3 # ì œì•½ ì¡°ê±´ ëª…ì‹œ
          maxItems: 5 # ì œì•½ ì¡°ê±´ ëª…ì‹œ
        learnerLevel:
          type: string
          description: í•™ìŠµì ìˆ˜ì¤€
          example: "JUNIOR"
          enum: [ "JUNIOR", "MIDDLE", "SENIOR", "EXPERT" ]
        job:
          type: string
          description: ì§ì—…/ì§ë¬´

    LoginRequest:
      type: object
      required:
        - email
        - password
      properties:
        email:
          type: string
          format: email
        password:
          type: string
          format: password

    LoginResponse:
      type: object

    ErrorResponse:
      type: object
      properties:
        code:
          type: string
          description: ë‚´ë¶€ ì—ëŸ¬ ì½”ë“œ (AUTH_004)
          example: "AUTH_004"
        message:
          type: string
          description: ì‚¬ìš©ì ì¹œí™”ì ì¸ ì—ëŸ¬ ë©”ì‹œì§€
          example: "ì´ë¯¸ ì‚¬ìš© ì¤‘ì¸ ì‚¬ìš©ì IDì…ë‹ˆë‹¤."


  # --- Security Schemes (ì¸ì¦ ë°©ì‹) ---
  securitySchemes:
    securitySchemes:
      cookieAuth:
        type: apiKey
        in: cookie
        name: access_token # ì„œë²„ê°€ ì‚¬ìš©í•˜ëŠ” ì¿ í‚¤ì˜ ì´ë¦„ (ì˜ˆì‹œ)
        description: 'ì¸ì¦ í† í°ì„ HTTP-only ì¿ í‚¤(ACCESS_TOKEN)ë¥¼ í†µí•´ ì „ì†¡í•©ë‹ˆë‹¤.'

  # --- Responses (ê³µí†µ ì‘ë‹µ) ---
  responses:
    BadRequestError:
      description: ì˜ëª»ëœ ìš”ì²­ í˜•ì‹ (ì¼ë°˜ì ì¸ ìœ íš¨ì„± ê²€ì‚¬ ì‹¤íŒ¨)
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          example:
            code: "VALIDATION_001"
            message: "Input validation failed: 'email' field is required."

    RegisterBadRequestError:
      description: íšŒì›ê°€ì… ìš”ì²­ ë°ì´í„° ìœ íš¨ì„± ê²€ì‚¬ ì‹¤íŒ¨
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          examples:
            TagSizeViolation:
              value:
                code: "AUTH_007"
                message: "íƒœê·¸ëŠ” ìµœì†Œ 3ê°œ, ìµœëŒ€ 5ê°œê¹Œì§€ ì…ë ¥í•´ì•¼ í•©ë‹ˆë‹¤."
            MissingField:
              value:
                code: "AUTH_005"
                message: "í•„ìˆ˜ ì¸ì¦ ì •ë³´(ID/PW)ê°€ ëˆ„ë½ë˜ì—ˆìŠµë‹ˆë‹¤."

    LoginUnauthorizedError:
      description: ì¸ì¦ ì‹¤íŒ¨ (ID/PW ë¶ˆì¼ì¹˜)
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          example:
            code: "AUTH_001"
            message: "ì•„ì´ë”” ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤."

    UnauthorizedError:
      description: ì¼ë°˜ì ì¸ ì¸ì¦ ì‹¤íŒ¨ (í† í° ë§Œë£Œ, í˜•ì‹ ì˜¤ë¥˜ ë“±)
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          example:
            code: "AUTH_002"
            message: "ìœ íš¨í•˜ì§€ ì•Šê±°ë‚˜ ë§Œë£Œëœ í† í°ì…ë‹ˆë‹¤."
