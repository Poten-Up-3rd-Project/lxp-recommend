spring:
  application:
    name: lxp-recommend

  datasource:
    url: jdbc:mysql://${DB_HOST:localhost}:${DB_PORT:3306}/${DB_NAME:lxp_recommend}?useSSL=false&serverTimezone=UTC&allowPublicKeyRetrieval=true
    username: ${DB_USERNAME:root}
    password: ${DB_PASSWORD:root}
    driver-class-name: com.mysql.cj.jdbc.Driver

  jpa:
    hibernate:
      ddl-auto: update
    show-sql: false
    properties:
      hibernate:
        format_sql: true

  flyway:
    enabled: false
    baseline-on-migrate: true
    locations: classpath:db/migration

  batch:
    job:
      enabled: false
    jdbc:
      initialize-schema: always

  rabbitmq:
    host: ${RABBITMQ_HOST:localhost}
    port: ${RABBITMQ_PORT:5672}
    username: ${RABBITMQ_USERNAME:guest}
    password: ${RABBITMQ_PASSWORD:guest}
    listener:
      simple:
        retry:
          enabled: true
          max-attempts: 3
          initial-interval: 1000
          multiplier: 2.0
          max-interval: 10000
        default-requeue-rejected: false
  data:
    redis:
      host: ${REDIS_HOST:localhost}
      port: ${REDIS_PORT:6379}

batch:
  schedule:
    cron: "0 0 0,6,12,18 * * *"
  chunk-size: 1000

r2:
  endpoint: ${R2_ENDPOINT_URL}
  access-key: ${R2_ACCESS_KEY_ID}
  secret-key: ${R2_SECRET_ACCESS_KEY}
  bucket: ${R2_BUCKET_NAME}
  region: ${R2_REGION:auto}

engine:
  base-url: ${RECOMMEND_ENGINE_URL:http://localhost:8000}
  callback-url: ${CALLBACK_URL:http://localhost:8080/internal/sync}
  top-k: 10

management:
  endpoints:
    web:
      exposure:
        include: health,info
  endpoint:
    health:
      show-details: always

logging:
  level:
    com.lxp.recommend: INFO
    org.springframework.batch: INFO
